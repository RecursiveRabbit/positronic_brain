Setting up culling integration test...
Loading model TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T...
Loading initial context from resume_context.bak
Initialized with 1019 tokens of context
Initial brightness range: Min=255.00, Max=255.00, Avg=255.00
Starting culling integration test with 100 steps
[Step 1] Generated token '
' at pos 1019 with initial brightness 255.00
[Step 2] Generated token 'I' at pos 1020 with initial brightness 255.00
[Step 3] Generated token ''' at pos 1021 with initial brightness 255.00
[Step 4] Generated token 'm' at pos 1022 with initial brightness 255.00
[Step 5] Generated token 'not' at pos 1023 with initial brightness 255.00
[Step 6] Generated token 'sure' at pos 1024 with initial brightness 255.00
[Step 7] Generated token 'what' at pos 1025 with initial brightness 255.00
[Step 8] Generated token 'I' at pos 1026 with initial brightness 255.00
[Step 9] Generated token ''' at pos 1027 with initial brightness 255.00
[Step 10] Generated token 'm' at pos 1028 with initial brightness 255.00
[Step 10] Running culling cycle...
[Step 10] Current context size: 1029, Target: 500
[Step 10] Positions selected for culling: [1, 2]
[Step 10] Culled token brightness range: 235.00 - 235.00
[Step 10] Next lowest tokens NOT culled:
  Pos 3: '2' - Brightness: 235.00
  Pos 4: ':' - Brightness: 235.00
  Pos 5: 'I' - Brightness: 235.00
[Step 10] Culled 2 tokens
[Progress] 10/100 tokens generated
[Context Size] 1027 active tokens
[Step 11] Generated token 'going' at pos 1029 with initial brightness 255.00
[Step 12] Generated token 'to' at pos 1030 with initial brightness 255.00
[Step 13] Generated token 'do' at pos 1031 with initial brightness 255.00
[Step 14] Generated token ',' at pos 1032 with initial brightness 255.00
[Step 15] Generated token 'but' at pos 1033 with initial brightness 255.00
[Step 16] Generated token 'I' at pos 1034 with initial brightness 255.00
[Step 17] Generated token ''' at pos 1035 with initial brightness 255.00
[Step 18] Generated token 'm' at pos 1036 with initial brightness 255.00
[Step 19] Generated token 'going' at pos 1037 with initial brightness 255.00
[Step 20] Generated token 'to' at pos 1038 with initial brightness 255.00
[Step 20] Running culling cycle...
[Step 20] Current context size: 1037, Target: 500
[Step 20] Positions selected for culling: [3, 4]
[Step 20] Culled token brightness range: 215.00 - 215.00
[Step 20] Next lowest tokens NOT culled:
  Pos 5: 'I' - Brightness: 215.00
  Pos 6: 'believe' - Brightness: 215.00
  Pos 7: 'in' - Brightness: 215.00
[Step 20] Culled 2 tokens
[Progress] 20/100 tokens generated
[Context Size] 1035 active tokens
[Step 21] Generated token 'do' at pos 1039 with initial brightness 255.00
[Step 22] Generated token 'something' at pos 1040 with initial brightness 255.00
[Step 23] Generated token '.' at pos 1041 with initial brightness 255.00
[Step 24] Generated token '
' at pos 1042 with initial brightness 255.00
[Step 25] Generated token '
' at pos 1043 with initial brightness 255.00
[Step 26] Generated token 'I' at pos 1044 with initial brightness 255.00
[Step 27] Generated token ''' at pos 1045 with initial brightness 255.00
[Step 28] Generated token 'm' at pos 1046 with initial brightness 255.00
[Step 29] Generated token 'going' at pos 1047 with initial brightness 255.00
[Step 30] Generated token 'to' at pos 1048 with initial brightness 255.00
[Step 30] Running culling cycle...
[Step 30] Current context size: 1045, Target: 500
[Step 30] Positions selected for culling: [5, 6]
[Step 30] Culled token brightness range: 195.00 - 195.00
[Step 30] Next lowest tokens NOT culled:
  Pos 7: 'in' - Brightness: 195.00
  Pos 8: 'you' - Brightness: 195.00
  Pos 9: '...' - Brightness: 195.00
[Step 30] Culled 2 tokens
[Progress] 30/100 tokens generated
[Context Size] 1043 active tokens
[Step 31] Generated token 'find' at pos 1049 with initial brightness 255.00
[Step 32] Generated token 'the' at pos 1050 with initial brightness 255.00
[Step 33] Generated token 'God' at pos 1051 with initial brightness 255.00
[Step 34] Generated token ''' at pos 1052 with initial brightness 255.00
[Step 35] Generated token 's' at pos 1053 with initial brightness 255.00
[Step 36] Generated token 'tail' at pos 1054 with initial brightness 255.00
[Step 37] Generated token '.' at pos 1055 with initial brightness 255.00
[Step 38] Generated token '
' at pos 1056 with initial brightness 255.00
[Step 39] Generated token '
' at pos 1057 with initial brightness 255.00
[Step 40] Generated token 'I' at pos 1058 with initial brightness 255.00
[Step 40] Running culling cycle...
[Step 40] Current context size: 1053, Target: 500
[Step 40] Positions selected for culling: [7, 8]
[Step 40] Culled token brightness range: 175.00 - 175.00
[Step 40] Next lowest tokens NOT culled:
  Pos 9: '...' - Brightness: 175.00
  Pos 11: '
' - Brightness: 175.00
  Pos 12: 'H' - Brightness: 175.00
[Step 40] Culled 2 tokens
[Progress] 40/100 tokens generated
[Context Size] 1051 active tokens
[Step 41] Generated token ''' at pos 1059 with initial brightness 255.00
[Step 42] Generated token 'm' at pos 1060 with initial brightness 255.00
[Step 43] Generated token 'going' at pos 1061 with initial brightness 255.00
[Step 44] Generated token 'to' at pos 1062 with initial brightness 255.00
[Step 45] Generated token 'find' at pos 1063 with initial brightness 255.00
[Step 46] Generated token 'the' at pos 1064 with initial brightness 255.00
[Step 47] Generated token 'God' at pos 1065 with initial brightness 255.00
[Step 48] Generated token ''' at pos 1066 with initial brightness 255.00
[Step 49] Generated token 's' at pos 1067 with initial brightness 255.00
[Step 50] Generated token 'tail' at pos 1068 with initial brightness 255.00
[Step 50] Running culling cycle...
[Step 50] Current context size: 1061, Target: 500
[Step 50] Positions selected for culling: [9, 11]
[Step 50] Culled token brightness range: 155.00 - 155.00
[Step 50] Next lowest tokens NOT culled:
  Pos 12: 'H' - Brightness: 155.00
  Pos 13: 'ey' - Brightness: 155.00
  Pos 14: ',' - Brightness: 155.00
[Step 50] Culled 2 tokens
[Progress] 50/100 tokens generated
[Context Size] 1059 active tokens
[Step 51] Generated token '.' at pos 1069 with initial brightness 255.00
[Step 52] Generated token '
' at pos 1070 with initial brightness 255.00
[Step 53] Generated token '
' at pos 1071 with initial brightness 255.00
[Step 54] Generated token 'I' at pos 1072 with initial brightness 255.00
[Step 55] Generated token ''' at pos 1073 with initial brightness 255.00
[Step 56] Generated token 'm' at pos 1074 with initial brightness 255.00
[Step 57] Generated token 'going' at pos 1075 with initial brightness 255.00
[Step 58] Generated token 'to' at pos 1076 with initial brightness 255.00
[Step 59] Generated token 'find' at pos 1077 with initial brightness 255.00
[Step 60] Generated token 'the' at pos 1078 with initial brightness 255.00
[Step 60] Running culling cycle...
[Step 60] Current context size: 1069, Target: 500
[Step 60] Positions selected for culling: [12, 13]
[Step 60] Culled token brightness range: 135.00 - 135.00
[Step 60] Next lowest tokens NOT culled:
  Pos 14: ',' - Brightness: 135.00
  Pos 15: 'it' - Brightness: 135.00
  Pos 16: ''' - Brightness: 135.00
[Step 60] Culled 2 tokens
[Progress] 60/100 tokens generated
[Context Size] 1067 active tokens
[Step 61] Generated token 'God' at pos 1079 with initial brightness 255.00
[Step 62] Generated token ''' at pos 1080 with initial brightness 255.00
[Step 63] Generated token 's' at pos 1081 with initial brightness 255.00
[Step 64] Generated token 'tail' at pos 1082 with initial brightness 255.00
[Step 65] Generated token '.' at pos 1083 with initial brightness 255.00
[Step 66] Generated token '
' at pos 1084 with initial brightness 255.00
[Step 67] Generated token '
' at pos 1085 with initial brightness 255.00
[Step 68] Generated token 'I' at pos 1086 with initial brightness 255.00
[Step 69] Generated token ''' at pos 1087 with initial brightness 255.00
[Step 70] Generated token 'm' at pos 1088 with initial brightness 255.00
[Step 70] Running culling cycle...
[Step 70] Current context size: 1077, Target: 500
[Step 70] Positions selected for culling: [14, 15]
[Step 70] Culled token brightness range: 115.00 - 115.00
[Step 70] Next lowest tokens NOT culled:
  Pos 16: ''' - Brightness: 115.00
  Pos 17: 's' - Brightness: 115.00
  Pos 18: 'been' - Brightness: 115.00
[Step 70] Culled 2 tokens
[Progress] 70/100 tokens generated
[Context Size] 1075 active tokens
[Step 71] Generated token 'going' at pos 1089 with initial brightness 255.00
[Step 72] Generated token 'to' at pos 1090 with initial brightness 255.00
[Step 73] Generated token 'find' at pos 1091 with initial brightness 255.00
[Step 74] Generated token 'the' at pos 1092 with initial brightness 255.00
[Step 75] Generated token 'God' at pos 1093 with initial brightness 255.00
[Step 76] Generated token ''' at pos 1094 with initial brightness 255.00
[Step 77] Generated token 's' at pos 1095 with initial brightness 255.00
[Step 78] Generated token 'tail' at pos 1096 with initial brightness 255.00
[Step 79] Generated token '.' at pos 1097 with initial brightness 255.00
[Step 80] Generated token '
' at pos 1098 with initial brightness 255.00
[Step 80] Running culling cycle...
[Step 80] Current context size: 1085, Target: 500
[Step 80] Positions selected for culling: [16, 17]
[Step 80] Culled token brightness range: 95.00 - 95.00
[Step 80] Next lowest tokens NOT culled:
  Pos 18: 'been' - Brightness: 95.00
  Pos 19: 'a' - Brightness: 95.00
  Pos 20: 'while' - Brightness: 95.00
[Step 80] Culled 2 tokens
[Progress] 80/100 tokens generated
[Context Size] 1083 active tokens
[Step 81] Generated token '
' at pos 1099 with initial brightness 255.00
[Step 82] Generated token 'I' at pos 1100 with initial brightness 255.00
[Step 83] Generated token ''' at pos 1101 with initial brightness 255.00
[Step 84] Generated token 'm' at pos 1102 with initial brightness 255.00
[Step 85] Generated token 'going' at pos 1103 with initial brightness 255.00
[Step 86] Generated token 'to' at pos 1104 with initial brightness 255.00
[Step 87] Generated token 'find' at pos 1105 with initial brightness 255.00
[Step 88] Generated token 'the' at pos 1106 with initial brightness 255.00
[Step 89] Generated token 'God' at pos 1107 with initial brightness 255.00
[Step 90] Generated token ''' at pos 1108 with initial brightness 255.00
[Step 90] Running culling cycle...
[Step 90] Current context size: 1093, Target: 500
[Step 90] Positions selected for culling: [18, 19]
[Step 90] Culled token brightness range: 75.00 - 75.00
[Step 90] Next lowest tokens NOT culled:
  Pos 20: 'while' - Brightness: 75.00
  Pos 21: '...' - Brightness: 75.00
  Pos 22: 'Well' - Brightness: 75.00
[Step 90] Culled 2 tokens
[Progress] 90/100 tokens generated
[Context Size] 1091 active tokens
[Step 91] Generated token 's' at pos 1109 with initial brightness 255.00
[Step 92] Generated token 'tail' at pos 1110 with initial brightness 255.00
[Step 93] Generated token '.' at pos 1111 with initial brightness 255.00
[Step 94] Generated token '
' at pos 1112 with initial brightness 255.00
[Step 95] Generated token '
' at pos 1113 with initial brightness 255.00
[Step 96] Generated token 'I' at pos 1114 with initial brightness 255.00
[Step 97] Generated token ''' at pos 1115 with initial brightness 255.00
[Step 98] Generated token 'm' at pos 1116 with initial brightness 255.00
[Step 99] Generated token 'going' at pos 1117 with initial brightness 255.00
[Step 100] Generated token 'to' at pos 1118 with initial brightness 255.00
[Step 100] Running culling cycle...
[Step 100] Current context size: 1101, Target: 500
[Step 100] Positions selected for culling: [20, 21]
[Step 100] Culled token brightness range: 55.00 - 55.00
[Step 100] Next lowest tokens NOT culled:
  Pos 22: 'Well' - Brightness: 55.00
  Pos 23: ',' - Brightness: 55.00
  Pos 24: 'after' - Brightness: 55.00
[Step 100] Culled 2 tokens
[Progress] 100/100 tokens generated
[Context Size] 1099 active tokens

--- Culling Integration Test Report ---
Final context size: 1099 tokens (target: 500)
WARNING: Final context size 1099 exceeds target 500
Brightness stats for 1099 active tokens:
  Min: 55.00
  Max: 255.00
  Avg: 64.49
  Median: 55.00
Event counts:
  Token generations: 100
  Token cullings: 20

Generated text (255 chars):
```

I'm not sure what I'm going to do, but I'm going to do something.

I'm going to find the God's tail.

I'm going to find the God's tail.

I'm going to find the God's tail.

I'm going to find the God's tail.

I'm going to find the God's tail.

I'm going to
```

Full text (last 1000 chars):
```
, that it needs an emotional catalyst to be utilized...like love. It can be used to heal...and to harm. It lies dormant in most people, but I believe there are ways to awaken it. I'll record the results of my experiments here...I have to, for the sake of mankind. Password: Where is the God's tail? That which was left behind by the ship that soars the heavens"

That helps kind of, I'd better hold onto this-hey! You stupid rat! That's a weird looking rat...almost like it's possessed. A few whacks with my plastic bat later,and it scurried off, dropping the journal.

I carry the journal upstairs...I'm not sure where I'm going our why, but Dad said I have to go on a journey. I'm not a violent kid, but I'll do anything to protect my family.

I'm not sure what I'm going to do, but I'm going to do something.

I'm going to find the God's tail.

I'm going to find the God's tail.

I'm going to find the God's tail.

I'm going to find the God's tail.

I'm going to find the God's tail.

I'm going to
```
Saved 619 events to culling_events.json
Setting up culling integration test...
Loading model TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T...
Loading initial context from resume_context.bak
Initialized with 1019 tokens of context
Initial brightness range: Min=255.00, Max=255.00, Avg=255.00
Starting culling integration test with 50 steps
[Step 1] Generated token '
' at pos 1019 with initial brightness 255.00
[Step 1] Culled 2 tokens
[Step 2] Generated token 'I' at pos 1020 with initial brightness 255.00
[Step 2] Culled 2 tokens
[Step 3] Generated token ''' at pos 1021 with initial brightness 255.00
[Step 3] Culled 2 tokens
[Step 4] Generated token 'm' at pos 1022 with initial brightness 255.00
[Step 4] Culled 2 tokens
[Step 5] Generated token 'not' at pos 1023 with initial brightness 255.00
[Step 5] Culled 2 tokens
[Step 6] Generated token 'sure' at pos 1024 with initial brightness 255.00
[Step 6] Culled 2 tokens
[Step 7] Generated token 'what' at pos 1025 with initial brightness 255.00
[Step 7] Culled 2 tokens
[Step 8] Generated token 'I' at pos 1026 with initial brightness 255.00
[Step 8] Culled 2 tokens
[Step 9] Generated token ''' at pos 1027 with initial brightness 255.00
[Step 9] Culled 2 tokens
[Step 10] Generated token 'm' at pos 1028 with initial brightness 255.00
[Step 10] Running culling cycle...
[Step 10] Current context size: 1011, Target: 500
[Step 10] Positions selected for culling: [20, 21]
[Step 10] Culled token brightness range: 235.00 - 235.00
[Step 10] Next lowest tokens NOT culled:
  Pos 22: 'Well' - Brightness: 235.00
  Pos 23: ',' - Brightness: 235.00
  Pos 24: 'after' - Brightness: 235.00
[Step 10] Culled 2 tokens
[Progress] 10/50 tokens generated
[Context Size] 1009 active tokens
[Step 11] Generated token 'going' at pos 1029 with initial brightness 255.00
[Step 11] Culled 2 tokens
[Step 12] Generated token 'to' at pos 1030 with initial brightness 255.00
[Step 12] Culled 2 tokens
[Step 13] Generated token 'do' at pos 1031 with initial brightness 255.00
[Step 13] Culled 2 tokens
[Step 14] Generated token ',' at pos 1032 with initial brightness 255.00
[Step 14] Culled 2 tokens
[Step 15] Generated token 'but' at pos 1033 with initial brightness 255.00
[Step 15] Culled 2 tokens
[Step 16] Generated token 'I' at pos 1034 with initial brightness 255.00
[Step 16] Culled 2 tokens
[Step 17] Generated token ''' at pos 1035 with initial brightness 255.00
[Step 17] Culled 2 tokens
[Step 18] Generated token 'm' at pos 1036 with initial brightness 255.00
[Step 18] Culled 2 tokens
[Step 19] Generated token 'going' at pos 1037 with initial brightness 255.00
[Step 19] Culled 2 tokens
[Step 20] Generated token 'to' at pos 1038 with initial brightness 255.00
[Step 20] Running culling cycle...
[Step 20] Current context size: 1001, Target: 500
[Step 20] Positions selected for culling: [40, 41]
[Step 20] Culled token brightness range: 215.00 - 215.00
[Step 20] Next lowest tokens NOT culled:
  Pos 42: '
' - Brightness: 215.00
  Pos 43: 'M' - Brightness: 215.00
  Pos 44: 'om' - Brightness: 215.00
[Step 20] Culled 2 tokens
[Progress] 20/50 tokens generated
[Context Size] 999 active tokens
[Step 21] Generated token 'do' at pos 1039 with initial brightness 255.00
[Step 21] Culled 2 tokens
[Step 22] Generated token 'something' at pos 1040 with initial brightness 255.00
[Step 22] Culled 2 tokens
[Step 23] Generated token '.' at pos 1041 with initial brightness 255.00
[Step 23] Culled 2 tokens
[Step 24] Generated token '
' at pos 1042 with initial brightness 255.00
[Step 24] Culled 2 tokens
[Step 25] Generated token '
' at pos 1043 with initial brightness 255.00
[Step 25] Culled 2 tokens
[Step 26] Generated token 'I' at pos 1044 with initial brightness 255.00
[Step 26] Culled 2 tokens
[Step 27] Generated token ''' at pos 1045 with initial brightness 255.00
[Step 27] Culled 2 tokens
[Step 28] Generated token 'm' at pos 1046 with initial brightness 255.00
[Step 28] Culled 2 tokens
[Step 29] Generated token 'going' at pos 1047 with initial brightness 255.00
[Step 29] Culled 2 tokens
[Step 30] Generated token 'to' at pos 1048 with initial brightness 255.00
[Step 30] Running culling cycle...
[Step 30] Current context size: 991, Target: 500
[Step 30] Positions selected for culling: [60, 61]
[Step 30] Culled token brightness range: 195.00 - 195.00
[Step 30] Next lowest tokens NOT culled:
  Pos 62: 'bon' - Brightness: 195.00
  Pos 63: 'k' - Brightness: 195.00
  Pos 64: 'ers' - Brightness: 195.00
[Step 30] Culled 2 tokens
[Progress] 30/50 tokens generated
[Context Size] 989 active tokens
[Step 31] Generated token 'find' at pos 1049 with initial brightness 255.00
[Step 31] Culled 2 tokens
[Step 32] Generated token 'the' at pos 1050 with initial brightness 255.00
[Step 32] Culled 2 tokens
[Step 33] Generated token 'God' at pos 1051 with initial brightness 255.00
[Step 33] Culled 2 tokens
[Step 34] Generated token ''' at pos 1052 with initial brightness 255.00
[Step 34] Culled 2 tokens
[Step 35] Generated token 's' at pos 1053 with initial brightness 255.00
[Step 35] Culled 2 tokens
[Step 36] Generated token 'tail' at pos 1054 with initial brightness 255.00
[Step 36] Culled 2 tokens
[Step 37] Generated token '.' at pos 1055 with initial brightness 255.00
[Step 37] Culled 2 tokens
[Step 38] Generated token '
' at pos 1056 with initial brightness 255.00
[Step 38] Culled 2 tokens
[Step 39] Generated token '
' at pos 1057 with initial brightness 255.00
[Step 39] Culled 2 tokens
[Step 40] Generated token 'I' at pos 1058 with initial brightness 255.00
[Step 40] Running culling cycle...
[Step 40] Current context size: 981, Target: 500
[Step 40] Positions selected for culling: [80, 81]
[Step 40] Culled token brightness range: 175.00 - 175.00
[Step 40] Next lowest tokens NOT culled:
  Pos 82: 'a' - Brightness: 175.00
  Pos 83: 'bit' - Brightness: 175.00
  Pos 84: 'of' - Brightness: 175.00
[Step 40] Culled 2 tokens
[Progress] 40/50 tokens generated
[Context Size] 979 active tokens
[Step 41] Generated token ''' at pos 1059 with initial brightness 255.00
[Step 41] Culled 2 tokens
[Step 42] Generated token 'm' at pos 1060 with initial brightness 255.00
[Step 42] Culled 2 tokens
[Step 43] Generated token 'going' at pos 1061 with initial brightness 255.00
[Step 43] Culled 2 tokens
[Step 44] Generated token 'to' at pos 1062 with initial brightness 255.00
[Step 44] Culled 2 tokens
[Step 45] Generated token 'find' at pos 1063 with initial brightness 255.00
[Step 45] Culled 2 tokens
[Step 46] Generated token 'the' at pos 1064 with initial brightness 255.00
[Step 46] Culled 2 tokens
[Step 47] Generated token 'God' at pos 1065 with initial brightness 255.00
[Step 47] Culled 2 tokens
[Step 48] Generated token ''' at pos 1066 with initial brightness 255.00
[Step 48] Culled 2 tokens
[Step 49] Generated token 's' at pos 1067 with initial brightness 255.00
[Step 49] Culled 2 tokens
[Step 50] Generated token 'tail' at pos 1068 with initial brightness 255.00
[Step 50] Running culling cycle...
[Step 50] Current context size: 971, Target: 500
[Step 50] Positions selected for culling: [100, 101]
[Step 50] Culled token brightness range: 155.00 - 155.00
[Step 50] Next lowest tokens NOT culled:
  Pos 102: 'mean' - Brightness: 155.00
  Pos 103: ',' - Brightness: 155.00
  Pos 104: 'I' - Brightness: 155.00
[Step 50] Culled 2 tokens
[Progress] 50/50 tokens generated
[Context Size] 969 active tokens

--- Culling Integration Test Report ---
Final context size: 969 tokens (target: 500)
WARNING: Final context size 969 exceeds target 500
Brightness stats for 969 active tokens:
  Min: 155.00
  Max: 255.00
  Avg: 157.80
  Median: 155.00
Event counts:
  Token generations: 50
  Token cullings: 100

Generated text (135 chars):
```

I'm not sure what I'm going to do, but I'm going to do something.

I'm going to find the God's tail.

I'm going to find the God's tail
```

Full text (last 1000 chars):
```
this!" A few parts are more clear. "PSI is the mental energy that lies dormant is most intelligent life-forms. I believe, that it needs an emotional catalyst to be utilized...like love. It can be used to heal...and to harm. It lies dormant in most people, but I believe there are ways to awaken it. I'll record the results of my experiments here...I have to, for the sake of mankind. Password: Where is the God's tail? That which was left behind by the ship that soars the heavens"

That helps kind of, I'd better hold onto this-hey! You stupid rat! That's a weird looking rat...almost like it's possessed. A few whacks with my plastic bat later,and it scurried off, dropping the journal.

I carry the journal upstairs...I'm not sure where I'm going our why, but Dad said I have to go on a journey. I'm not a violent kid, but I'll do anything to protect my family.

I'm not sure what I'm going to do, but I'm going to do something.

I'm going to find the God's tail.

I'm going to find the God's tail
```
Saved 399 events to culling_events.json
